import{S as u,i as g,s as _,y as f,z as b,A as d,g as k,d as h,B as y,J as $,a2 as v}from"../chunks/index.0bca4926.js";import{X as l,Y as S}from"../chunks/Page.svelte_svelte_type_style_lang.8d655cf0.js";import{i as P}from"../chunks/navigation.e461c846.js";import{P as q}from"../chunks/Page.88295953.js";import{a as B}from"../chunks/utils.0f4ac802.js";function D(o){let t,n;return t=new q({props:{page:{...o[0].page,sections:o[0].sections}}}),{c(){f(t.$$.fragment)},l(e){b(t.$$.fragment,e)},m(e,a){d(t,e,a),n=!0},p(e,[a]){const c={};a&1&&(c.page={...e[0].page,sections:e[0].sections}),t.$set(c)},i(e){n||(k(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function U(o,t,n){let e;$(o,l,s=>n(1,e=s));let{data:a}=t;const{supabase:c}=a,i=B(),r=c.channel("locked-blocks",{config:{presence:{key:i}}});return r.subscribe(async s=>{s==="SUBSCRIBED"&&r.track({active_block:null})}),r.on("presence",{event:"sync"},()=>{const s=r.presenceState();v(l,e=Object.entries(s).map(([p,m])=>({key:p,block_id:m[0].active_block,user:m[0].user})).filter(p=>p.key!==i),e)}),S(async s=>{r.track({...s,presence_key:i,user:{email:a.user.email}})}),c.channel("schema-db-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"sections",filter:`page=eq.${a.page.id}`},()=>{P("app:data")}).subscribe(),o.$$set=s=>{"data"in s&&n(0,a=s.data)},[a]}class w extends u{constructor(t){super(),g(this,t,U,D,_,{data:0})}}export{w as component};
//# sourceMappingURL=7.ab9c7014.js.map
