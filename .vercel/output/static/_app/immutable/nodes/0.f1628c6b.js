import{c as D,P as L,a as M,M as B,s as I}from"../chunks/Modal.344f08ec.js";import{r as R}from"../chunks/index.c6708bed.js";import{_ as K}from"../chunks/preload-helper.a4192956.js";import{S as J,i as z,s as G,C as F,y as H,a as X,z as W,c as q,A as V,b as Y,D as Z,E as Q,F as ee,g as w,d as S,B as te,h as re,o as oe,G as C}from"../chunks/index.0bca4926.js";import{l as ne,e as ae,i as ie}from"../chunks/navigation.e461c846.js";import{r as se}from"../chunks/Page.svelte_svelte_type_style_lang.8d655cf0.js";new TextEncoder;const ce=new TextDecoder,ue=e=>{const t=atob(e),r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r},le=e=>{let t=e;t instanceof Uint8Array&&(t=ce.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return ue(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}},de=le;var fe=Object.create,P=Object.defineProperty,pe=Object.getOwnPropertyDescriptor,A=Object.getOwnPropertyNames,he=Object.getPrototypeOf,_e=Object.prototype.hasOwnProperty,me=(e,t)=>function(){return t||(0,e[A(e)[0]])((t={exports:{}}).exports,t),t.exports},ge=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of A(t))!_e.call(e,s)&&s!==r&&P(e,s,{get:()=>t[s],enumerable:!(o=pe(t,s))||o.enumerable});return e},x=(e,t,r)=>(r=e!=null?fe(he(e)):{},ge(t||!e||!e.__esModule?P(r,"default",{value:e,enumerable:!0}):r,e)),T=me({"../../node_modules/.pnpm/cookie@0.5.0/node_modules/cookie/index.js"(e){e.parse=o,e.serialize=s;var t=Object.prototype.toString,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function o(i,f){if(typeof i!="string")throw new TypeError("argument str must be a string");for(var _={},l=f||{},b=l.decode||a,p=0;p<i.length;){var d=i.indexOf("=",p);if(d===-1)break;var h=i.indexOf(";",p);if(h===-1)h=i.length;else if(h<d){p=i.lastIndexOf(";",d-1)+1;continue}var m=i.slice(p,d).trim();if(_[m]===void 0){var g=i.slice(d+1,h).trim();g.charCodeAt(0)===34&&(g=g.slice(1,-1)),_[m]=u(g,b)}p=h+1}return _}function s(i,f,_){var l=_||{},b=l.encode||n;if(typeof b!="function")throw new TypeError("option encode is invalid");if(!r.test(i))throw new TypeError("argument name is invalid");var p=b(f);if(p&&!r.test(p))throw new TypeError("argument val is invalid");var d=i+"="+p;if(l.maxAge!=null){var h=l.maxAge-0;if(isNaN(h)||!isFinite(h))throw new TypeError("option maxAge is invalid");d+="; Max-Age="+Math.floor(h)}if(l.domain){if(!r.test(l.domain))throw new TypeError("option domain is invalid");d+="; Domain="+l.domain}if(l.path){if(!r.test(l.path))throw new TypeError("option path is invalid");d+="; Path="+l.path}if(l.expires){var m=l.expires;if(!c(m)||isNaN(m.valueOf()))throw new TypeError("option expires is invalid");d+="; Expires="+m.toUTCString()}if(l.httpOnly&&(d+="; HttpOnly"),l.secure&&(d+="; Secure"),l.priority){var g=typeof l.priority=="string"?l.priority.toLowerCase():l.priority;switch(g){case"low":d+="; Priority=Low";break;case"medium":d+="; Priority=Medium";break;case"high":d+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}}if(l.sameSite){var j=typeof l.sameSite=="string"?l.sameSite.toLowerCase():l.sameSite;switch(j){case!0:d+="; SameSite=Strict";break;case"lax":d+="; SameSite=Lax";break;case"strict":d+="; SameSite=Strict";break;case"none":d+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return d}function a(i){return i.indexOf("%")!==-1?decodeURIComponent(i):i}function n(i){return encodeURIComponent(i)}function c(i){return t.call(i)==="[object Date]"||i instanceof Date}function u(i,f){try{return f(i)}catch{return i}}}}),y=x(T()),N=x(T());function O(e){if(!e)return null;try{const t=JSON.parse(e);if(!t)return null;if(t.constructor.name==="Object")return t;if(t.constructor.name!=="Array")throw new Error(`Unexpected format: ${t.constructor.name}`);const[r,o,s]=t[0].split("."),a=de(o),n=new TextDecoder,{exp:c,sub:u,...i}=JSON.parse(n.decode(a));return{expires_at:c,expires_in:c-Math.round(Date.now()/1e3),token_type:"bearer",access_token:t[0],refresh_token:t[1],provider_token:t[2],provider_refresh_token:t[3],user:{id:u,factors:t[4],...i}}}catch(t){return console.warn("Failed to parse cookie string:",t),null}}function ve(e){var t;return JSON.stringify([e.access_token,e.refresh_token,e.provider_token,e.provider_refresh_token,((t=e.user)==null?void 0:t.factors)??null])}function v(){return typeof window<"u"&&typeof window.document<"u"}var E={path:"/",sameSite:"lax",maxAge:60*60*24*365*1e3};function U(e){return new RegExp(".{1,"+e+"}","g")}var $=3180,be=U($);function ye(e,t,r){const o=r!==void 0?U(r):be;if(Math.ceil(t.length/(r??$))===1)return[{name:e,value:t}];const a=[],n=t.match(o);return n==null||n.forEach((c,u)=>{const i=`${e}.${u}`;a.push({name:i,value:c})}),a}function ke(e,t=()=>null){let r=[];for(let o=0;;o++){const s=`${e}.${o}`,a=t(s);if(!a)break;r.push(a)}return r.length?r.join(""):null}var we=class{constructor(e){this.cookieOptions={...E,...e,maxAge:E.maxAge}}getItem(e){const t=this.getCookie(e);if(e.endsWith("-code-verifier")&&t)return t;if(t)return JSON.stringify(O(t));const r=ke(e,o=>this.getCookie(o));return r!==null?JSON.stringify(O(r)):null}setItem(e,t){if(e.endsWith("-code-verifier")){this.setCookie(e,t);return}let r=JSON.parse(t);const o=ve(r);ye(e,o).forEach(a=>{this.setCookie(a.name,a.value)})}removeItem(e){this._deleteSingleCookie(e),this._deleteChunkedCookies(e)}_deleteSingleCookie(e){this.getCookie(e)&&this.deleteCookie(e)}_deleteChunkedCookies(e,t=0){for(let r=t;;r++){const o=`${e}.${r}`;if(this.getCookie(o)===void 0)break;this.deleteCookie(o)}}},Se=class extends we{constructor(e){super(e)}getCookie(e){return v()?(0,y.parse)(document.cookie)[e]:null}setCookie(e,t){if(!v())return null;document.cookie=(0,y.serialize)(e,t,{...this.cookieOptions,httpOnly:!1})}deleteCookie(e){if(!v())return null;document.cookie=(0,y.serialize)(e,"",{...this.cookieOptions,maxAge:0,httpOnly:!1})}};function Ce(e,t,r){var o;const s=v();return D(e,t,{...r,auth:{flowType:"pkce",autoRefreshToken:s,detectSessionInUrl:s,persistSession:!0,storage:r.auth.storage,...(o=r.auth)!=null&&o.storageKey?{storageKey:r.auth.storageKey}:{}}})}N.parse;N.serialize;/*! Bundled license information:

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/var Oe=class extends Se{constructor(e=null,t){super(t),this.serverSession=e}getItem(e){return v()?super.getItem(e):JSON.stringify(this.serverSession)}},k;function Ee({supabaseUrl:e,supabaseKey:t,event:r,serverSession:o,options:s,cookieOptions:a}){var n;const c=v();if(c&&k)return k;const u=Ce(e,t,{...s,global:{fetch:r.fetch,...s==null?void 0:s.global,headers:{...(n=s==null?void 0:s.global)==null?void 0:n.headers,"X-Client-Info":"@supabase/auth-helpers-sveltekit@0.10.7"}},auth:{storage:new Oe(o,a)}});return c&&(k=u),u}async function Pe(e){var o;e.depends("supabase:auth"),e.depends("app:data");const t=Ee({supabaseUrl:L,supabaseKey:M,event:{fetch},serverSession:(o=e==null?void 0:e.data)==null?void 0:o.session}),{data:{session:r}}=await t.auth.getSession();if(!r&&!e.url.pathname.startsWith("/auth"))R(303,"/auth");else if(r){const{sites:s,user:a}=await Promise.all([t.from("sites").select("id, name, url, active_deployment, collaborators (*)").order("created_at",{ascending:!0}),t.from("users").select("*, server_members (admin, role), collaborators (role)").eq("id",r.user.id).single()]).then(([{data:c},{data:u}])=>{const[i]=u.server_members,[f]=u.collaborators,_=i?{...u,server_member:!0,admin:i.admin,role:i.role}:{...u,server_member:!1,admin:!1,role:f.role};return{sites:c||[],user:_}}),n=s==null?void 0:s.filter(c=>a.server_member||c.collaborators.some(u=>u.user===a.id));return{supabase:t,session:r,user:a,sites:n}}}const Le=Object.freeze(Object.defineProperty({__proto__:null,load:Pe},Symbol.toStringTag,{value:"Module"}));function Ae(e){let t,r,o;t=new B({});const s=e[3].default,a=F(s,e,e[2],null);return{c(){H(t.$$.fragment),r=X(),a&&a.c()},l(n){W(t.$$.fragment,n),r=q(n),a&&a.l(n)},m(n,c){V(t,n,c),Y(n,r,c),a&&a.m(n,c),o=!0},p(n,[c]){a&&a.p&&(!o||c&4)&&Z(a,s,n,n[2],o?ee(s,n[2],c,null):Q(n[2]),null)},i(n){o||(w(t.$$.fragment,n),w(a,n),o=!0)},o(n){S(t.$$.fragment,n),S(a,n),o=!1},d(n){te(t,n),n&&re(r),a&&a.d(n)}}}function xe(e,t,r){let{$$slots:o={},$$scope:s}=t,{data:a}=t,{supabase:n,session:c}=a;return oe(()=>{if(!n)return;const{data:{subscription:u}}=n.auth.onAuthStateChange((i,f)=>{(f==null?void 0:f.expires_at)!==(c==null?void 0:c.expires_at)&&ie("supabase:auth")});return()=>u.unsubscribe()}),K(()=>import("../chunks/processors.d064a23d.js"),["..\\chunks\\processors.d064a23d.js","..\\chunks\\preload-helper.a4192956.js","..\\chunks\\Page.svelte_svelte_type_style_lang.8d655cf0.js","..\\chunks\\index.0bca4926.js","..\\chunks\\index.a02c07a6.js","..\\chunks\\navigation.e461c846.js","..\\chunks\\singletons.8ee9b9e3.js","..\\chunks\\stores.fea94504.js","..\\assets\\Page.0bc2413d.css"],import.meta.url).then(({html:u,css:i})=>{se({html:u,css:i})}),C("track",()=>{}),C("DEBUGGING",new URLSearchParams(window.location.search).has("debug")),ne(["gg:spinner","material-symbols:edit-square-outline-rounded","pepicons-pop:trash","gridicons:external"]),ae("local"),e.$$set=u=>{"data"in u&&r(0,a=u.data),"$$scope"in u&&r(2,s=u.$$scope)},e.$$.update=()=>{e.$$.dirty&1&&r(1,{supabase:n,session:c}=a,c),e.$$.dirty&2&&c&&I.auth.setSession({access_token:c.access_token,refresh_token:c.refresh_token})},[a,c,s,o]}class Me extends J{constructor(t){super(),z(this,t,xe,Ae,G,{data:0})}}export{Me as component,Le as universal};
//# sourceMappingURL=0.f1628c6b.js.map
